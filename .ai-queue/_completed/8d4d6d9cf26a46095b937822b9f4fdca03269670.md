# Commit History

| Hash | Message |
|------|---------|
| 8d4d6d9cf26a46095b937822b9f4fdca03269670 | feat(primitives): implement all 13 src/primitives components (merge) |
| 37c3acafc489683866a36db9fcc851c9e7a13d1c | feat(primitives): implement Select, Dialog, Sheet, Tooltip primitives |
| 78f7832cffdcbc0f37ce9ee5db4698a56dfedd2b | feat(primitives): implement Checkbox, RadioGroup, Switch primitives |
| a760648525cf8a85b96391e27a567855ef644eee | feat(primitives): implement Avatar primitive |
| 290faf90b7999a3b5d45ab4911cf17aa9dc0ce75 | feat(primitives): implement Input and TextArea primitives |
| f145fefb36f6b91da5c2c6fd58527d44fb5e2c7 | feat(primitives): implement Button primitive |
| 4498b79c98bd78e51b5a77b23e7f1c7e25a8f7c9 | feat(primitives): implement Stack and Text primitives |

---

# Implement `src/primitives` Components

## Context

All 13 primitives in `src/primitives/` are currently empty stubs — each one just does `styled(YStack, {})`. This task is to replace every stub with a real, spec-compliant Tamagui v2 implementation.

Before starting, read:
- `AI_CONSTITUTION.md` (no business logic, presentation-only, accessibility mandatory)
- `DESIGN_CONSTITUTION.md` (UX laws, token-first, no hardcoded values)
- Each component's `.spec.md` file — follow it strictly

---

## Setup

Use `q -t` to create a git worktree and work inside it:

```
q -t (Primitives Implementation): Implement all 13 src/primitives components
```

---

## Key Technical Constraints

- **Tamagui version**: `2.0.0-rc.14` — consult docs and types carefully
- **`name` prop on `styled()`** causes a TS error in v2 RC — omit it
- **`interface extends GetProps<>`** causes TS2411 — use `type` intersection instead: `type FooProps = GetProps<typeof FooFrame> & { ... }`
- **Palette arrays** must be `string[]` NOT `readonly string[]`
- **`createMedia` does NOT exist** in v2 — use a plain object `as const`
- Tokens: use `$0`–`$16` scales for size/space; color tokens from the theme builder
- No hardcoded hex colors, pixel sizes, or raw font values — all values must come from tokens
- Cross-platform: components must work on both web (react-dom) and React Native (react-native-web)
- No business logic, no data fetching, no Supabase, no Jotai

---

## Available Tamagui Imports

All from the `tamagui` package (v2) unless noted:
- Layout: `XStack`, `YStack`, `Stack`, `View`
- Typography: `Text` (from tamagui)
- Form inputs: `Input`, `TextArea`
- Interactive: `Button` (use as base or compose), `Pressable`
- Compound: `Dialog`, `Sheet`, `Tooltip`, `Select`, `Checkbox`, `RadioGroup`, `Switch`
- Utilities: `styled`, `GetProps`, `withStaticProperties`, `useTheme`, `useMedia`, `Image`
- Icons: `@tamagui/lucide-icons`

---

## Components to Implement

Work through them in this order (simpler first):

### 1. Stack (`src/primitives/Stack/Stack.tsx`)

Replace with a proper layout primitive. Stack should be a thin wrapper that exposes `direction` (vertical/horizontal) as a prop, mapping to `flexDirection`. Compose both vertical and horizontal directions from `YStack` and `XStack`.

```tsx
// Pattern: expose direction prop
// Default direction: vertical (YStack)
// Horizontal direction: XStack
// Gap, align, justify, wrap, padding all pass through via Tamagui props
// Export: Stack, HStack (horizontal convenience), VStack (vertical convenience)
```

Read `Stack.spec.md` for full requirements.

### 2. Text (`src/primitives/Text/Text.tsx`)

Replace `styled(YStack, {})` with `styled(Text, {})` from tamagui. Add a `variant` prop (`display`, `heading`, `subheading`, `body`, `label`, `caption`, `overline`) mapped to type scale tokens. Add `color`, `weight`, `align`, `numberOfLines`, `italic` props.

```tsx
import { Text as TamaguiText, styled } from 'tamagui'

const TextFrame = styled(TamaguiText, {
  variants: {
    variant: {
      body: { fontSize: '$4', lineHeight: '$4' },
      // ... etc
    },
  } as const,
  defaultVariants: {
    variant: 'body',
  },
})
```

Read `Text.spec.md` for full requirements including `as` prop for semantic HTML.

### 3. Button (`src/primitives/Button/Button.tsx`)

Compound component with variants: `primary`, `secondary`, `tertiary`, `destructive`. Supports `size`, `loading`, `disabled`, `fullWidth`, `icon` (leading/trailing), `onPress`.

```tsx
// Pattern: compound with withStaticProperties (if sub-parts needed)
// Use Tamagui's pressable/animatable base
// Loading: show spinner, block onPress
// Disabled: aria-disabled, muted styles
// Variants drive background/border/text color from tokens
```

Read `Button.spec.md` for full requirements (variants, states, a11y, motion).

### 4. Input (`src/primitives/Input/Input.tsx`)

Replace with `styled(Input)` from tamagui. Add `label`, `helperText`, `errorText`, `error` (boolean), `disabled`, `size` props. Compose the label, input, and helper/error text into a container.

```tsx
// Pattern: compound component
// InputFrame = styled(TamaguiInput, { ... })
// InputLabel = styled(TamaguiText, { ... })
// InputHelper = styled(TamaguiText, { ... })
// Export Input as the composed container
```

Read `Input.spec.md` for a11y requirements (`aria-invalid`, `aria-describedby`, `aria-required`).

### 5. TextArea (`src/primitives/TextArea/TextArea.tsx`)

Similar to Input but multi-line. Use `styled(TextArea)` from tamagui. Add `label`, `helperText`, `errorText`, `error`, `rows`, `autoGrow`, `maxRows` props.

Read `TextArea.spec.md`.

### 6. Avatar (`src/primitives/Avatar/Avatar.tsx`)

Compound component: shows an image if `src` is provided, otherwise renders initials (max 2 chars from `name`) or a generic icon. Supports `size` and `shape` (`circle`, `square`).

```tsx
// Pattern: compound with sub-parts via withStaticProperties
// Avatar.Image — the img element
// Avatar.Fallback — initials or icon container
// Initials: first letter of each word in name, max 2
// Shape: circle (borderRadius = 9999) | square (borderRadius from tokens)
// Size: mapped from size tokens
```

Read `Avatar.spec.md` for a11y (alt text, aria-label for fallback).

### 7. Checkbox (`src/primitives/Checkbox/Checkbox.tsx`)

Use Tamagui's `Checkbox` as the base or compose a custom one. Support `checked`, `defaultChecked`, `indeterminate`, `onCheckedChange`, `disabled`, `label`, `description`, `error`.

```tsx
// Tamagui v2 has Checkbox — wrap it with label composition
// Indeterminate state: aria-checked="mixed"
// Full-row touch target (label + control are both tappable)
```

Read `Checkbox.spec.md`.

### 8. RadioGroup (`src/primitives/RadioGroup/RadioGroup.tsx`)

Compound component: `RadioGroup` wraps multiple `RadioGroup.Item` elements. Use Tamagui's `RadioGroup` as the base.

```tsx
// RadioGroup — the container (role="radiogroup")
// RadioGroup.Item — individual option with label
// Props: value, onValueChange, disabled, orientation
```

Read `RadioGroup.spec.md`.

### 9. Switch (`src/primitives/Switch/Switch.tsx`)

Toggle control for on/off settings that take effect immediately. Use Tamagui's `Switch` as the base. Support `checked`, `defaultChecked`, `onCheckedChange`, `disabled`, `size`, `label`.

Read `Switch.spec.md`.

### 10. Select (`src/primitives/Select/Select.tsx`)

Compound component for single-value selection from a list. Use Tamagui's `Select` as the base.

```tsx
// Select — root container
// Select.Trigger — the visible trigger button
// Select.Content — the dropdown panel
// Select.Item — individual option
// Props: value, defaultValue, onValueChange, disabled, placeholder
```

Read `Select.spec.md`.

### 11. Dialog (`src/primitives/Dialog/Dialog.tsx`)

Modal overlay compound component using Tamagui's `Dialog`.

```tsx
// Dialog — root
// Dialog.Trigger — opens the dialog
// Dialog.Content — the panel (centered, focus trapped)
// Dialog.Title — h2 heading
// Dialog.Description — optional description
// Dialog.Close — close button
// Props: open, defaultOpen, onOpenChange, modal
```

Read `Dialog.spec.md`.

### 12. Sheet (`src/primitives/Sheet/Sheet.tsx`)

Bottom sheet / slide-up overlay using Tamagui's `Sheet`.

```tsx
// Sheet — root
// Sheet.Trigger — opens the sheet
// Sheet.Frame — the sliding panel
// Sheet.Handle — drag handle
// Sheet.Overlay — backdrop
// Props: open, defaultOpen, onOpenChange, snapPoints, dismissOnOverlayPress
```

Read `Sheet.spec.md`.

### 13. Tooltip (`src/primitives/Tooltip/Tooltip.tsx`)

Contextual hint overlay using Tamagui's `Tooltip`.

```tsx
// Tooltip — root
// Tooltip.Trigger — the wrapped element
// Tooltip.Content — the hint panel
// Props: content (string | ReactNode), placement, delay, open, defaultOpen
```

Read `Tooltip.spec.md`.

---

## Test Updates

After implementing each component, update its `.test.tsx` file to go beyond the current smoke test. Add tests covering:
- All key variants/states described in the spec's §9 Test Requirements
- Basic a11y attributes (aria-* props where relevant)
- `onPress` / `onCheckedChange` / `onValueChange` callbacks fire correctly
- Disabled state blocks callbacks

Do NOT rewrite every test from scratch — expand incrementally. Use the test utils from `src/__test-utils__/render`.

---

## Commit Convention

Use **Conventional Commits**. Commit each primitive separately:

```
feat(primitives): implement Stack primitive
feat(primitives): implement Text primitive
feat(primitives): implement Button primitive
...
```

---

## Definition of Done

- [ ] All 13 `*.tsx` stubs replaced with real implementations
- [ ] Each implementation passes its spec's requirements (§3–§7)
- [ ] TypeScript compiles with no new errors (`tsc --noEmit`)
- [ ] All existing tests pass; new tests cover spec §9 requirements
- [ ] No hardcoded hex colors, pixel values, or raw font sizes anywhere
- [ ] No business logic, no data fetching, no external deps beyond `tamagui`
- [ ] Worktree merged and cleaned up; instruction file moved to `_completed/`
