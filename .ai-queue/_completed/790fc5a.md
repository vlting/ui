<!-- auto-queue -->
# Commit History
- `2cf22f4` fix(kitchen-sink): overlay crash, paginated table, and brand-aware shell
- `790fc5a` feat(kitchen-sink): fix overlays, add pagination, and brand-aware shell (#004)

<!-- depends-on: 001, 002, 003 -->
# 004 — Kitchen Sink Example Fixes (Integration Segment)

## Summary

Fix the kitchen-sink example app to resolve broken pages, update demos to use corrected components, and ensure the app body background reflects the theme.

## Scope

- `examples/kitchen-sink/src/pages/OverlaysPage.tsx`
- `examples/kitchen-sink/src/pages/ComposedPage.tsx`
- `examples/kitchen-sink/src/pages/ComponentsPage.tsx`
- `examples/kitchen-sink/src/layouts/BrandLayout.tsx`

## Tasks

### 1. OverlaysPage — Fix undefined component error

**Problem:** The Overlays page crashes with:
```
Uncaught Error: Element type is invalid: expected a string (for built-in components)
or a class/function (for composite components) but got: undefined.
Check the render method of `OverlaysPage`.
```

**File:** `examples/kitchen-sink/src/pages/OverlaysPage.tsx`

**Current imports:**
```tsx
import { HoverCard, Drawer, Dialog, Tooltip, Button } from '@vlting/ui'
```

**Diagnosis:** One of the imported components is `undefined`. The most likely candidates are:
1. `Drawer` — check if Drawer is actually exported from `@vlting/ui`. Look at `src/index.ts` to verify.
2. `HoverCard` — check if HoverCard is exported.

**Fix:**
- Check `src/index.ts` to verify which components are exported
- If `Drawer` or `HoverCard` is not exported, either:
  - Add the export to `src/index.ts` (if the component exists in `packages/components/`)
  - OR remove the demo that uses the missing component and replace with a placeholder comment

**IMPORTANT:** Do NOT modify `src/index.ts` — that file is outside this segment's scope. If a component is missing from exports, remove/comment-out its usage in the demo page and add a `{/* TODO: Add Drawer demo when exported */}` comment.

Actually, wait — if `src/index.ts` needs updating, we need to handle it. Let me add it to scope.

**Updated scope note:** If `src/index.ts` needs a new export line added, that is allowed as part of this segment since no other segment touches it.

### 2. ComponentsPage — Dialog demo fix

**Problem:** The "Open Dialog" button shows the overlay backdrop but no dialog content appears. This is because Dialog.Content is not portaled (fixed in segment 003 at the component level).

**File:** `examples/kitchen-sink/src/pages/ComponentsPage.tsx`

**Current code:**
```tsx
<Dialog.Root open={dialogOpen} onOpenChange={setDialogOpen}>
  <Dialog.Trigger>...</Dialog.Trigger>
  <Dialog.Overlay />
  <Dialog.Content>...</Dialog.Content>
</Dialog.Root>
```

**After segment 003's fix:** Dialog.Content will self-portal, so this usage pattern should work. Verify it does. If it still doesn't work correctly, wrap Content inside Overlay as a fallback:
```tsx
<Dialog.Overlay>
  <Dialog.Content>...</Dialog.Content>
</Dialog.Overlay>
```

### 3. ComponentsPage — Avatar with feedback

**Problem:** The user asks "What is the 'avatar with feedback'? Is it supposed to have a popup?"

**Investigation needed:** Search the ComponentsPage for any "avatar with feedback" label or similar. If it exists as a demo, determine what it's supposed to do:
- If it's supposed to show a popup/tooltip on hover with user info → wrap Avatar in a HoverCard or Tooltip
- If it's just showing an avatar with a status indicator (online/offline dot) → ensure the status dot is visible
- If this demo doesn't exist in the page, skip this task

### 4. ComponentsPage — ToggleGroup orientation

**After segment 002's fix:** ToggleGroup should default to horizontal. Verify the demo renders horizontally. If for some reason it still renders vertically, explicitly pass `orientation="horizontal"` in the demo:
```tsx
<ToggleGroup type="single" value={...} onValueChange={...} orientation="horizontal">
```

### 5. ComposedPage — Table with pagination

**Problem:** The composed table should have pagination too.

**File:** `examples/kitchen-sink/src/pages/ComposedPage.tsx`

**Current code:** `TableDemo` renders a static table with 5 rows and no pagination.

**Fix:** Add pagination to the table demo:
1. Import `Pagination` from `@vlting/ui`
2. Add state for current page: `const [tablePage, setTablePage] = useState(1)`
3. Define a larger dataset (e.g., 15-20 rows) and paginate them (5 per page)
4. Render `Pagination.Root` below the table:
```tsx
<Pagination.Root
  currentPage={tablePage}
  totalPages={Math.ceil(allRows.length / ROWS_PER_PAGE)}
  onPageChange={setTablePage}
  size="sm"
/>
```
5. Slice the data array based on current page: `allRows.slice((tablePage - 1) * ROWS_PER_PAGE, tablePage * ROWS_PER_PAGE)`

### 6. ComposedPage — Collapsible demo

**After segment 003's fix:** The Collapsible trigger should no longer have a mismatched border radius. Verify visually. The demo itself should still work fine.

### 7. BrandLayout — App body background from theme

**Problem:** The app background is hardcoded: `bg = isDark ? '#09090b' : '#ffffff'`. It doesn't reflect the active brand's theme colors.

**File:** `examples/kitchen-sink/src/layouts/BrandLayout.tsx`

**Current code:**
```tsx
const bg = isDark ? '#09090b' : '#ffffff'
```

**Fix:** The body/shell background should use the brand's theme background color. Since the BrandLayout is rendered OUTSIDE the Provider (the Provider wraps only `<Outlet />`), we can't use Tamagui tokens directly in the layout styles.

**Approach:** Get the background color from the brand's palette:
- Light theme background = palette step 0 (lightest)
- Dark theme background = palette step 0 (darkest)

Access the palette from the brand definition. In `brands.ts`, the `activeBrand` only exports `config`. To get palette colors, we need to also export the brand definition.

**Changes to `examples/kitchen-sink/src/brands.ts`:** Export the active brand definition:
```ts
export const activeBrand = {
  key: activeBrandKey,
  config: activeConfig,
  definition: activeDef,
}
```

**Changes to `BrandLayout.tsx`:**
```tsx
const palette = activeBrand.definition.palettes
const bg = isDark ? palette.dark[0] : palette.light[0]
const fg = isDark ? palette.dark[11] : palette.light[11]
// ... derive other colors from the palette too
```

This way the app shell (header, sidebar, background) will match the brand's color scheme.

**Also update these derived colors:**
- `muted` — use a mid-palette color (e.g., index 7-8)
- `border` — use palette index 4-5
- `bgMuted` — use palette index 1-2
- `bgHover` — use palette index 2-3
- `accent` — use palette index 10-11

### 8. BrandLayout — Export brands.ts definition

**File:** `examples/kitchen-sink/src/brands.ts`

Add `definition: activeDef` to the `activeBrand` export object so the layout can access palette colors.

## Additional scope (if needed)

- `examples/kitchen-sink/src/brands.ts` (exporting brand definition)
- `src/index.ts` (adding missing exports if Drawer/HoverCard aren't exported)

## Acceptance Criteria

- [ ] OverlaysPage loads without crashing
- [ ] Dialog demo shows actual dialog content when opened (not just backdrop)
- [ ] ToggleGroup demo renders horizontally
- [ ] Composed table has working pagination
- [ ] App background, header, and sidebar colors reflect the active brand's palette
- [ ] No console errors on any page
- [ ] Works correctly in all 4 brand themes (default, shadcn, fun, posh)
- [ ] Works in both light and dark mode
