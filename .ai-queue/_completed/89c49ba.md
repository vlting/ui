<!-- auto-queue -->
# Commit History
- c396abe fix(components): use theme tokens for overlay background and dialog shadows
- 89c49ba fix(components): overlay tokens and dialog shadows (#001)

# 001 — Dialog & AlertDialog: Shadow Tokens via Brand Config

## Objective

The Dialog and AlertDialog overlay backgrounds are hardcoded to `rgba(0,0,0,0.4)` / `rgba(0,0,0,0.5)`. These values should come from the brand config / theme tokens so that each brand can define its own overlay appearance. The Dialog content should also use a brand-aware dark shadow by default (not white/light shadows).

## Context

- The brand config system (`BrandDefinition`) already supports `shadows?: { light?: ShadowScale; dark?: ShadowScale }`.
- Theme builder (`buildThemes`) already converts shadow scales into theme tokens (`$shadowSm`, `$shadowMd`, etc.).
- Each brand defines different shadow philosophies: Fun = flat/transparent, Posh = soft/diffused, shadcn = Tailwind-style, Default = standard.
- The AI Constitution (Rule 2.6) and Design Constitution (Section 12) prohibit hardcoded colors in components.
- The Dialog spec (`Dialog.spec.md`) and contract (`Dialog.contract.md`) currently document the hardcoded overlay as intentional — these need updating.

## Tasks

1. **Add overlay theme tokens to the theme builder** (`packages/design-tokens/themes.ts`):
   - Add new semantic tokens: `overlayBackground` (the scrim color for modal overlays).
   - In `buildThemes()`, inject these tokens into `nonInheritedValues` for both light and dark themes.
   - Default values: light theme → `rgba(0,0,0,0.5)`, dark theme → `rgba(0,0,0,0.6)`.

2. **Add overlay config to brand definitions** (`packages/design-tokens/brands/*.ts`):
   - Extend `BrandDefinition` type to include `overlay?: { light?: string; dark?: string }` in `packages/design-tokens/brands/index.ts` (or wherever the type lives).
   - Add appropriate overlay values per brand:
     - **Default**: `rgba(0,0,0,0.5)` (current behavior, standard scrim)
     - **Fun**: `rgba(0,0,0,0.25)` (lighter, playful)
     - **Posh**: `rgba(0,0,0,0.6)` (deeper, more dramatic)
     - **shadcn**: `rgba(0,0,0,0.5)` (matches shadcn conventions)

3. **Update Dialog component** (`packages/components/Dialog/Dialog.tsx`):
   - Replace hardcoded `backgroundColor="rgba(0,0,0,0.4)"` on the Overlay with `backgroundColor="$overlayBackground"`.
   - Ensure Dialog.Content uses dark shadows by default — set `elevation` or `shadowColor` to use shadow tokens from the theme (e.g., `$shadowLg` or `$shadowXl`), not hardcoded or transparent.

4. **Update AlertDialog component** (`packages/components/AlertDialog/AlertDialog.tsx`):
   - Same overlay fix: replace `backgroundColor="rgba(0,0,0,0.5)"` with `backgroundColor="$overlayBackground"`.
   - Remove `elevation={0}` and `shadowColor="transparent"` from Content — use brand-aware shadow tokens instead.

5. **Update spec and contract files**:
   - `packages/components/Dialog/Dialog.spec.md`: Remove the exception for hardcoded overlay background. Document that overlay uses `$overlayBackground` token.
   - `packages/components/Dialog/Dialog.contract.md`: Update Section 4 to reference the token instead of the fixed rgba value.

6. **Verify** the changes work across all 4 brands in both light and dark modes. The overlay should look consistent with each brand's shadow philosophy.

## Scope

- `packages/design-tokens/themes.ts`
- `packages/design-tokens/brands/index.ts` (type definition)
- `packages/design-tokens/brands/default.ts`
- `packages/design-tokens/brands/fun.ts`
- `packages/design-tokens/brands/posh.ts`
- `packages/design-tokens/brands/shadcn.ts`
- `packages/components/Dialog/Dialog.tsx`
- `packages/components/AlertDialog/AlertDialog.tsx`
- `packages/components/Dialog/Dialog.spec.md`
- `packages/components/Dialog/Dialog.contract.md`
