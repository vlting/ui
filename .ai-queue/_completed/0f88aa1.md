<!-- auto-queue -->
# Commit History
- `0f88aa1` — chore(queue): complete task 011 — replace main with v2/scaffold

# Task 011: Replace `main` with `v2/scaffold`

## Objective
Safely remove the old `main` branch (and all its history) and promote `v2/scaffold` to be the new `main`. After this task, `main` should point to the exact commit tree that `v2/scaffold` currently has, both locally and on `origin`.

## Context
- `v2/scaffold` is an **orphan branch** — it shares zero history with `main` (no merge-base exists).
- The old `main` contains legacy v1/v5 code that is fully superseded.
- Remote: `origin` at `https://github.com/vlting/ui.git`
- Local branches to be aware of: `main`, `v2/scaffold`, `v2/layered-rewrite`

## Steps

### 1. Pre-flight checks
- Confirm you are on `v2/scaffold` and the working tree is clean (`git status`).
- Confirm `main` and `v2/scaffold` share no merge-base (`git merge-base main v2/scaffold` should fail).
- Note the current HEAD of `v2/scaffold` (save the SHA for verification later).

### 2. Delete the local `main` branch
```bash
git branch -D main
```

### 3. Rename `v2/scaffold` → `main`
```bash
git branch -m v2/scaffold main
```
This renames the current branch in-place, preserving all history and HEAD.

### 4. Update the remote

**IMPORTANT: These are destructive remote operations. Ask the user for explicit confirmation before executing each one.**

#### 4a. Push the new `main` to origin (force required since histories diverge)
```bash
git push --force-with-lease origin main
```

#### 4b. Delete the old `v2/scaffold` remote ref
```bash
git push origin --delete v2/scaffold
```

#### 4c. Set upstream tracking
```bash
git branch --set-upstream-to=origin/main main
```

### 5. Update GitHub default branch (if needed)
- Check if `main` is already the default branch on GitHub:
  ```bash
  gh repo view --json defaultBranchRef -q '.defaultBranchRef.name'
  ```
- If it's not `main`, set it:
  ```bash
  gh api -X PATCH repos/vlting/ui -f default_branch=main
  ```

### 6. Clean up stale remote refs
```bash
git fetch --prune origin
```

### 7. Verify
- `git branch -a` should show `main` locally and `remotes/origin/main` with the correct SHA.
- `git log --oneline -3` should show the same recent commits as the old `v2/scaffold`.
- The old `main` history (starting with `9fc492e fix new version`) should be gone.
- `v2/layered-rewrite` local branch is left untouched (no action needed unless user requests).

## Safety Notes
- **Do NOT force-push without `--force-with-lease`** — this protects against overwriting concurrent pushes.
- **Ask the user for confirmation before every destructive remote operation** (steps 4a, 4b).
- If anything goes wrong, the old `main` can be recovered from `origin/main` until the force-push in step 4a completes.
