# Commit History

- `87c442e` — docs: add front-of-frontend guardrails to constitution files
- `8e72e91` — merge commit into main

---

<!-- auto-queue -->
# Enhance Constitution Files with Front-of-Frontend Guardrails

## Objective

Add specific, actionable "front of frontend" rules to `AI_CONSTITUTION.md` and `DESIGN_CONSTITUTION.md`. These rules should address gaps around semantic HTML enforcement, DOM structure optimization, spacing/alignment discipline, and contrast verification — areas where AI-generated code commonly falls short.

## Context

The existing constitutions are strong but somewhat high-level on front-of-frontend concerns. For example:
- `AI_CONSTITUTION.md` §2.5 says "Use semantic HTML where possible" — but doesn't specify what that means concretely (e.g., never use `<div>` with `onClick` as a button)
- `DESIGN_CONSTITUTION.md` §4 covers accessibility principles but doesn't address DOM optimization or redundant markup
- Neither constitution addresses the common AI antipattern of wrapping content in unnecessary `<div>`s for styling

## Changes to AI_CONSTITUTION.md

Add a new section **§2.8 Semantic HTML & DOM Structure** (after §2.7 Stability Over Novelty) with these rules:

### Semantic Element Rules
- **Interactive elements**: Use `<button>` for actions, `<a>` for navigation. NEVER use `<div>`, `<span>`, or Tamagui `View`/`XStack`/`YStack` with `onPress`/`onClick` as a substitute for `<button>` or `<a>`.
- **Headings**: Use `<h1>`–`<h6>` in logical order. Never skip heading levels. In Tamagui, use the `Heading` component with the `level` prop (which renders `styledHtml('h1')`, etc.).
- **Forms**: Every `<input>` must have an associated `<label>` via `htmlFor`/`id`. Use `<form>`, `<fieldset>`, and `<legend>` for form structure. Use `<select>` for native dropdowns.
- **Lists**: Use `<ul>`/`<ol>` for lists of items, not a stack of `<div>`s.
- **Tables**: Use `<table>`, `<thead>`, `<tbody>`, `<th>`, `<td>` for tabular data.
- **Landmarks**: Use `<header>`, `<nav>`, `<main>`, `<aside>`, `<footer>` for page structure.

### DOM Optimization Rules
- **No styling-only wrappers**: Never add a `<div>` or `<View>` solely for padding, margin, or alignment when those styles can be applied directly to the parent or child element. Example violation: `<button><div style={{padding: 20}}>Text</div></button>` — the padding belongs on the `<button>`.
- **Minimal nesting**: Components should produce the minimum DOM nodes necessary. Audit rendered output (not just source) to verify.
- **Compound component wrappers**: Sub-components (e.g., `Button.Text`, `Button.Icon`) should use `styled()` on existing elements, not wrap in additional containers.
- **Tamagui-specific**: The `tag` prop in `styled()` does NOT change the rendered HTML element. Use `styledHtml('button')` or native HTML elements with Tamagui styling wrappers.

### Rendered Output Verification
- After creating or modifying a component, verify the rendered DOM structure to ensure:
  1. Correct semantic elements are used
  2. No unnecessary wrapper elements exist
  3. ARIA attributes are present where needed (and absent where native semantics suffice)

## Changes to DESIGN_CONSTITUTION.md

### Add §4.6 Contrast Verification (under §4 Accessibility Principles)
- Normal text: minimum 4.5:1 contrast ratio (WCAG 1.4.3)
- Large text (18px+ or 14px+ bold): minimum 3:1 contrast ratio
- UI components and graphical objects: minimum 3:1 contrast ratio (WCAG 1.4.11)
- Focus indicators: minimum 3:1 contrast ratio against adjacent colors (WCAG 2.4.11)
- **Verification**: Use AccessLint MCP's `calculate_contrast_ratio` or `analyze_color_pair` when selecting or modifying colors

### Add §4.7 Touch Target Sizing (under §4 Accessibility Principles)
- All interactive elements must have a minimum target size of 24x24 CSS pixels (WCAG 2.5.8)
- Recommended target size: 44x44 CSS pixels for primary actions
- Inline links within text are exempt from minimum size requirements

### Add §8.1 Spacing & Alignment Discipline (under §8 Layout Behavior)
- All spacing values (padding, margin, gap) must use design tokens from the space scale (`$0.5` through `$10`)
- No hardcoded pixel values for spacing
- Related elements should be grouped using consistent gap values (Gestalt proximity)
- Alignment must be intentional — elements that appear aligned must BE aligned (no "close enough" visual alignment)
- Grid and flex alignment should use `alignItems`, `justifyContent`, and `gap` — not manual margin hacks

### Add §8.2 DOM Structure Quality (under §8 Layout Behavior)
- Rendered DOM must use the minimum elements necessary to achieve the design
- Never add a wrapper element solely for one CSS property that could be applied to an existing element
- Audit component output in browser DevTools to verify DOM structure matches intent
- Cross-reference: see `AI_CONSTITUTION.md` §2.8 for semantic HTML rules

## Scope
- **Modifies**: `AI_CONSTITUTION.md`, `DESIGN_CONSTITUTION.md`
- **Does NOT modify**: any other files

## Quality Criteria
- New sections should match the tone, formatting, and specificity level of existing sections
- Rules should be concrete and actionable (not vague platitudes)
- Include the "why" briefly — e.g., why no styling-only wrappers (performance, a11y tree noise, maintainability)
- Do not remove or weaken any existing rules
- Keep section numbering consistent with existing structure
