<!-- auto-queue -->
# Commit History
- `a71ef1d` fix(components): overlay component bugs and hardcoded values
- `398aab8` fix(components): overlay component bugs and hardcoded values (#001) [merge]

# Fix Overlay Components at UI Lib Level

Fix critical bugs and replace hardcoded values in overlay components. These are UI lib-level fixes — not example/demo fixes.

## 1. ContextMenu — Children Rendering Bug (CRITICAL)

**File:** `packages/components/ContextMenu/ContextMenu.tsx`

**Bug:** Line 88: `{React.Children.map(children, () => null)}` maps ALL children to `null` inside the popup menu. The menu popup renders empty.

**Root cause:** The `Root` component receives `children` (which includes `<ContextMenu.Trigger>`, `<ContextMenu.Content>`, etc.) and renders them inline for the trigger area (line 57). When the menu opens (line 59-91), it tries to re-render `children` in the popup but maps them to null.

**Fix:** The component needs to separate Trigger children from Content children. The pattern should be:
1. `Root` renders `Trigger` children inline (for the right-click area)
2. When the menu opens, `Root` renders `Content` children inside the positioned popup

Implementation approach:
- Use `React.Children.forEach` to find children of type `Trigger` and `Content`
- Render Trigger children in the trigger wrapper
- Render Content children inside the popup when `open` is true
- The `Content` sub-component currently just passes through children (`<>{children}</>`) — it needs to participate in this separation

Also replace the hardcoded `boxShadow` on line 84 with the theme shadow token `$shadowMd` (or use Tamagui's `shadowColor`/`shadowRadius`/`shadowOffset` props).

## 2. AlertDialog — Content Renders Inline

**File:** `packages/components/AlertDialog/AlertDialog.tsx`

**Bug:** The `Content` function (lines 85-106) renders `<AlertContent>` WITHOUT wrapping it in `<AlertPortal>`. Compare with the `Overlay` function (lines 61-82) which correctly wraps in `<AlertPortal>`. This means AlertDialog content renders inline in the DOM rather than in a portal, causing it to appear visible on the page without being triggered.

**Fix:** Wrap `<AlertContent>` in `<AlertPortal>`:
```tsx
function Content({ children }: { children: React.ReactNode }) {
  return (
    <AlertPortal>
      <AlertContent ...>
        {children}
      </AlertContent>
    </AlertPortal>
  )
}
```

Also ensure the Overlay doesn't double-wrap in its own portal since Content now has one. The Overlay should be rendered inside the same portal as Content, or each can have their own portal (Tamagui supports this).

## 3. Dialog — Flash on Open

**File:** `packages/components/Dialog/Dialog.tsx`

**Bug:** The dialog flashes on screen instead of fading in smoothly. The animation props are present (`animation="medium"`, `enterStyle={{ opacity: 0, scale: 0.95 }}`) but may not be working.

**Investigate and fix:**
- Check if `animation="medium"` resolves to a valid animation config. The medium animation is `ease-in-out 250ms` which should be smooth enough.
- The `Content` is wrapped in `<DialogPortal>` separately from the `Overlay`. The portal remounting might cause a flash. Try combining Overlay and Content into the same portal, or ensure animation timing works.
- If Tamagui v2 RC animations aren't working reliably, add a CSS fallback transition via `style={{ transition: 'opacity 200ms ease-out, transform 200ms ease-out' }}`.

## 4. HoverCard — Positioning Fix

**File:** `packages/components/HoverCard/HoverCard.tsx`

**Bug:** HoverCard centers on the Root wrapper container, not on the Trigger element specifically. The Root (line 62) wraps ALL children in `position="relative" display="inline-flex"`. The Content positions `absolute` relative to Root. If the Root is wider than the Trigger (e.g., because of surrounding layout), the centering is wrong.

**Fix:** The Trigger should be the positioning anchor, not the Root. Approach:
1. Add a ref to the Trigger wrapper
2. Use the Trigger ref to calculate Content positioning
3. OR: restructure so Trigger is the `position: relative` parent and Content renders inside it

Also replace the hardcoded `boxShadow` on line 106 with theme shadow tokens (`shadowColor`/`shadowRadius`/`shadowOffset` props or `$shadowMd`).

## General: Replace All Hardcoded Values with Theme Tokens

For ALL files in this segment, audit every style value and ensure it comes from the brand config/theme, not hardcoded. Specifically:
- Replace any hardcoded `boxShadow` CSS strings with Tamagui shadow props (`shadowColor="$shadowMdColor"`, `shadowRadius`, `shadowOffset`) or `$shadowMd` token
- Replace any hardcoded `rgb(...)`, `rgba(...)`, hex colors with theme tokens
- Replace any hardcoded pixel sizes with token references where appropriate
- Verify all `backgroundColor`, `borderColor`, `color` use theme tokens (most already do)

## Scope
- `packages/components/ContextMenu/ContextMenu.tsx`
- `packages/components/Dialog/Dialog.tsx`
- `packages/components/AlertDialog/AlertDialog.tsx`
- `packages/components/HoverCard/HoverCard.tsx`

## Acceptance Criteria
- ContextMenu popup renders its menu items (not null/empty)
- AlertDialog content only appears when triggered, not inline
- Dialog fades in smoothly without flashing
- HoverCard centers on the trigger element, not the wrapper
- No hardcoded shadow or color values remain in these files
- All shadow/color values come from theme tokens
- TypeScript compiles cleanly
